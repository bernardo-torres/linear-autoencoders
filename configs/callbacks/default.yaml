test_model:
  _target_: linear_cae.callbacks.test_model.TestModelCallback
  num_log_examples: ${num_log_examples}
  # crop_test_audio: ${data.crop_test_audio}
  # crop_to_length: ${data.crop_to_length}
  # batch_size_eval: 20
  reconstruction_loss: true
  equivariance_loss: true
  log_examples: true
  log_latents: true
  diffusion_steps: 4
  validation_sets: ${data.validation_sets}
  test_sets: ${data.test_sets}


model_checkpoint:
  _target_: lightning.pytorch.callbacks.ModelCheckpoint
  dirpath: ${paths.ckpt_dir} # directory to save the model file
  filename: "{step:06d}-{val/jamendo_99/MR-STFT:.3f}-{loss:.3f}" # filename template, can include format specifiers
  # monitor: null # name of the logged metric which determines when model is improving
  monitor: "val/jamendo_99/MR-STFT"
  verbose: False # verbosity mode
  save_last: true # additionally always save an exact copy of the last checkpoint to a file last.ckpt
  save_top_k: 1 # save k best models (determined by above metric)
  mode: "min" # "max" means higher metric value is better, can be also "min"
  auto_insert_metric_name: True # when True, the checkpoints filenames will contain the metric name
  save_weights_only: False # if True, then only the modelâ€™s weights will be saved
  # every_n_train_steps: 50 # number of training steps between checkpoints
  every_n_epochs: null # number of epochs between checkpoints
  save_on_train_epoch_end: true # if True, then the checkpoint will be saved at the end of the epoch
